"use strict";(self.webpackChunkbludyclud=self.webpackChunkbludyclud||[]).push([[823],{823:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});var a=s(43),r=s(231),n=s(579);const l=function(){var e;const{id:t}=(0,r.g)(),[s,l]=(0,a.useState)(null),o=(0,r.Zp)(),[i,c]=(0,a.useState)(!0),[d,u]=(0,a.useState)(""),[h,m]=(0,a.useState)(""),[g,p]=(0,a.useState)(""),[j,x]=(0,a.useState)(!1),[v,b]=(0,a.useState)(!0),f=localStorage.getItem("loggedInUser");return(0,a.useEffect)((()=>{if(!t)return console.error("Missing ID parameter!"),void o("/");fetch(`https://localhost:5001/api/games/${t}`).then((e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()})).then((e=>{l(e),c(!1)})).catch((e=>{console.error("Error fetching game details:",e),c(!1)})),fetch(`https://localhost:5001/api/users/${f}`).then((e=>e.json())).then((e=>b(e.canRate))).catch((e=>console.error("canRate kontrol\xfc ba\u015far\u0131s\u0131z:",e)))}),[t,o,f]),i?(0,n.jsx)("p",{children:"Loading..."}):s?(0,n.jsx)("div",{className:"game-detail-page",children:(0,n.jsxs)("div",{className:"game-detail-container",children:[(0,n.jsxs)("div",{className:"left-panel",children:[(0,n.jsx)("img",{src:null===s||void 0===s?void 0:s.photo,alt:(null===s||void 0===s?void 0:s.name)||"Game"}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Average Rating:"})," ",s.rating||"Not rated yet"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Genre:"})," ",(null===(e=s.genres)||void 0===e?void 0:e.join(", "))||"Not specified"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Release Date:"})," ",s.releaseDate||"Unknown"]})]}),(0,n.jsxs)("div",{className:"right-panel",children:[(0,n.jsx)("h2",{children:"Comments and Ratings"}),s.comments&&s.comments.length>0?s.comments.map(((e,t)=>(0,n.jsxs)("div",{className:"comment-box",children:[(0,n.jsx)("strong",{children:e.username})," ",e.rating&&"\u2b50".repeat(e.rating),(0,n.jsx)("br",{}),e.text," ",(0,n.jsxs)("span",{children:["(",e.playTime," hours)"]})]},t))):(0,n.jsx)("p",{children:"No comments yet."}),s.isRatingEnabled&&v?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{children:"Leave a Comment & Rate"}),(0,n.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=Number(d),a=Number(h);if(console.log("parsedRating:",t),console.log("parsedPlayTime:",a),isNaN(t)||isNaN(a))alert("Rating and Play Time must be valid numbers.");else try{const e=await fetch(`https://localhost:5001/api/games/${s._id}/interact`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rating:t,playTime:a,comment:g,username:f})});if(!e.ok)throw new Error("Server error!");const{updatedGame:r}=await e.json();l(r),x(!0),u(""),m(""),p(""),alert("Your comment was submitted successfully!")}catch(r){console.error("Submit error:",r),alert("Submission failed due to server error.")}},className:"interact-form",children:[(0,n.jsx)("label",{children:"Rating (Stars):"}),(0,n.jsxs)("select",{value:d,onChange:e=>u(e.target.value),required:!0,children:[(0,n.jsx)("option",{value:"",children:"Select"}),(0,n.jsx)("option",{value:"1",children:"\u2b50"}),(0,n.jsx)("option",{value:"2",children:"\u2b50\u2b50"}),(0,n.jsx)("option",{value:"3",children:"\u2b50\u2b50\u2b50"}),(0,n.jsx)("option",{value:"4",children:"\u2b50\u2b50\u2b50\u2b50"}),(0,n.jsx)("option",{value:"5",children:"\u2b50\u2b50\u2b50\u2b50\u2b50"})]}),(0,n.jsx)("label",{children:"Play Time (hours):"}),(0,n.jsx)("input",{type:"number",value:h,onChange:e=>m(e.target.value),min:"1",required:!0}),(0,n.jsx)("label",{children:"Comment:"}),(0,n.jsx)("textarea",{value:g,onChange:e=>p(e.target.value),placeholder:"Your thoughts...",required:!0}),(0,n.jsx)("button",{type:"submit",children:"Submit"}),j&&(0,n.jsx)("p",{className:"submitted-msg",children:"Submitted successfully!"})]})]}):(0,n.jsx)("p",{style:{color:"red"},children:"Rating and comments are disabled for this game or you are not authorized."})]})]})}):(0,n.jsx)("p",{children:"Game not found."})}}}]);
//# sourceMappingURL=823.aae473c9.chunk.js.map